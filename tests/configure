#!/bin/sh
all="$all tests"

tests() {
	for t in \
		00-constants \
		01-arrays \
		02-integers \
		03-pointers \
		04-strings
	do
		cat <<EOF
tests/$t: libhart.a tests/$t.ha
	@printf 'HAREC %s\t$@\n' "tests/$t"
	@./harec -o tests/$t.ssa tests/$t.ha
	@\$(QBE) -o tests/$t.s tests/$t.ssa
	@\$(AS) -o tests/$t.o tests/$t.s
	@\$(LD) -o tests/$t $rtstart tests/$t.o libhart.a
	@rm tests/$t.s tests/$t.ssa tests/$t.o

check: tests/$t

clean-test-$t:
	@rm -f tests/$t

clean-tests: clean-test-$t
EOF
	done
}

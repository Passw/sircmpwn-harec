#!/bin/sh -e
srcdir=${SRCDIR:-$(dirname "$0")}

enable_rt=0

option() {
	case $1 in
		--enable-rt)
			enable_rt=1
			;;
		*)
			printf 'Unknown option %s\n' "$arg" >&2
			exit 1
			;;
	esac
}

eval ". $srcdir/config.sh"

harec() {
	genrules harec \
		src/check.c \
		src/emit.c \
		src/eval.c \
		src/gen.c \
		src/identifier.c \
		src/lex.c \
		src/main.c \
		src/parse.c \
		src/qbe.c \
		src/qinstr.c \
		src/qtype.c \
		src/scope.c \
		src/trace.c \
		src/type_store.c \
		src/types.c \
		src/utf8.c \
		src/util.c
}

all="harec"

if [ $enable_rt -eq 1 ]
then
	subdir rt
fi

run_configure
